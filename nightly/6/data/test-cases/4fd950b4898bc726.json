{"uid":"4fd950b4898bc726","name":"[WEB Component] [WEB Component] Category filter group should be collapsed after expand another group","fullName":"tests.web.component.filter.test_category_filter.TestCategoryFilter#test_category_filter_should_have_screenshot_when_expand_collapse_expanded","historyId":"2a536620c08dced62c24b9be09e1a297","time":{"start":1771975638833,"stop":1771975649004,"duration":10171},"status":"failed","statusMessage":"AssertionError: Category filter screenshot mismatch","statusTrace":"self = <tests.web.component.filter.test_category_filter.TestCategoryFilter object at 0x7f9211bd2190>\n\n    @pytest.mark.screenshot_test\n    @allure.label(\"owner\", \"arrnel\")\n    @allure.story(\"[Web] Component - Category Filter\")\n    @allure.title(\n        \"[WEB Component] [WEB Component] Category filter group should be collapsed after expand another group\"\n    )\n    def test_category_filter_should_have_screenshot_when_expand_collapse_expanded(self):\n        # Component\n        category_filter = self.main_page.category_filter\n    \n        # Data\n        group1 = DataGenerator().random_user_type().value\n        group2 = DataGenerator().random_user_type_except(UserType(group1)).value\n    \n        # Steps\n        self.main_page.navigate()\n        category_filter.expand_group(group1)\n        category_filter.expand_group(group2)\n    \n        # Assertions\n>       self.main_page.category_filter.check_component_has_screenshot(\n            path_to_screenshot=f\"files/screenshot/component/filter/category/expanded_{group2.lower()}.png\",\n            percent_of_tolerance=PERCENT_OF_TOLERANCE,\n            timeout=0.5,\n        )\n\ntests/web/component/filter/test_category_filter.py:106: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/util/decorator/step_logger.py:75: in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\nsrc/ui/component/base_component.py:67: in check_component_has_screenshot\n    screenshot_util.compare_and_save_screenshot(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nactual_screenshot = <PIL.Image.Image image mode=RGB size=263x210 at 0x7F921195F750>\npath_to_screenshot = 'files/screenshot/component/filter/category/expanded_kids.png'\npercent_of_tolerance = 0.002, rewrite_screenshot = False\ncomponent_name = 'Category filter'\n\n    def compare_and_save_screenshot(\n        actual_screenshot: Image.Image,\n        path_to_screenshot: str,\n        percent_of_tolerance: float = 0,\n        rewrite_screenshot: bool = False,\n        component_name: str = \"Component\",\n    ) -> None:\n    \n        abs_path = system_util.get_path_in_resources(path_to_screenshot)\n        expected_not_exists = not os.path.exists(abs_path)\n    \n        if expected_not_exists:\n            image_util.create_blank_image(abs_path, actual_screenshot.size)\n    \n        expected_screenshot = Image.open(abs_path, formats=[\"PNG\"])\n        screen_diff = ScreenDiffResult(\n            expected=expected_screenshot,\n            actual=actual_screenshot,\n            percent_of_tolerance=percent_of_tolerance,\n        )\n    \n        if expected_not_exists or CFG.rewrite_all_screenshots or rewrite_screenshot:\n            actual_screenshot.save(abs_path, save_all=True)\n    \n        screen_diff.attach_diff_to_allure()\n    \n        if screen_diff.has_diff and not CFG.rewrite_all_screenshots:\n>           raise AssertionError(f\"{component_name} screenshot mismatch\")\nE           AssertionError: Category filter screenshot mismatch\n\nsrc/util/screenshot/screenshot_util.py:67: AssertionError","flaky":true,"newFailed":true,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"_session_faker","time":{"start":1771975410221,"stop":1771975410222,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"All test fixtures","time":{"start":1771975410222,"stop":1771975410223,"duration":1},"status":"passed","steps":[{"name":"Tests configuration data","time":{"start":1771975410223,"stop":1771975410223,"duration":0},"status":"passed","steps":[],"attachments":[{"uid":"a0b681d4b8a9da91","name":"Configuration","source":"a0b681d4b8a9da91.txt","type":"text/plain","size":1705}],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":1,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"stepsCount":1,"shouldDisplayMessage":false,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},{"name":"All UI tests fixture","time":{"start":1771975410223,"stop":1771975410223,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Each test fixtures","time":{"start":1771975620570,"stop":1771975620570,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Each UI test fixture","time":{"start":1771975620571,"stop":1771975638778,"duration":18207},"status":"passed","steps":[{"name":"Open browser","time":{"start":1771975620571,"stop":1771975638778,"duration":18207},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"stepsCount":1,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"_xunit_setup_method_fixture_TestCategoryFilter","time":{"start":1771975638779,"stop":1771975638833,"duration":54},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"status":"failed","statusMessage":"AssertionError: Category filter screenshot mismatch","statusTrace":"self = <tests.web.component.filter.test_category_filter.TestCategoryFilter object at 0x7f9211bd2190>\n\n    @pytest.mark.screenshot_test\n    @allure.label(\"owner\", \"arrnel\")\n    @allure.story(\"[Web] Component - Category Filter\")\n    @allure.title(\n        \"[WEB Component] [WEB Component] Category filter group should be collapsed after expand another group\"\n    )\n    def test_category_filter_should_have_screenshot_when_expand_collapse_expanded(self):\n        # Component\n        category_filter = self.main_page.category_filter\n    \n        # Data\n        group1 = DataGenerator().random_user_type().value\n        group2 = DataGenerator().random_user_type_except(UserType(group1)).value\n    \n        # Steps\n        self.main_page.navigate()\n        category_filter.expand_group(group1)\n        category_filter.expand_group(group2)\n    \n        # Assertions\n>       self.main_page.category_filter.check_component_has_screenshot(\n            path_to_screenshot=f\"files/screenshot/component/filter/category/expanded_{group2.lower()}.png\",\n            percent_of_tolerance=PERCENT_OF_TOLERANCE,\n            timeout=0.5,\n        )\n\ntests/web/component/filter/test_category_filter.py:106: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/util/decorator/step_logger.py:75: in wrapper\n    return func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^\nsrc/ui/component/base_component.py:67: in check_component_has_screenshot\n    screenshot_util.compare_and_save_screenshot(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nactual_screenshot = <PIL.Image.Image image mode=RGB size=263x210 at 0x7F921195F750>\npath_to_screenshot = 'files/screenshot/component/filter/category/expanded_kids.png'\npercent_of_tolerance = 0.002, rewrite_screenshot = False\ncomponent_name = 'Category filter'\n\n    def compare_and_save_screenshot(\n        actual_screenshot: Image.Image,\n        path_to_screenshot: str,\n        percent_of_tolerance: float = 0,\n        rewrite_screenshot: bool = False,\n        component_name: str = \"Component\",\n    ) -> None:\n    \n        abs_path = system_util.get_path_in_resources(path_to_screenshot)\n        expected_not_exists = not os.path.exists(abs_path)\n    \n        if expected_not_exists:\n            image_util.create_blank_image(abs_path, actual_screenshot.size)\n    \n        expected_screenshot = Image.open(abs_path, formats=[\"PNG\"])\n        screen_diff = ScreenDiffResult(\n            expected=expected_screenshot,\n            actual=actual_screenshot,\n            percent_of_tolerance=percent_of_tolerance,\n        )\n    \n        if expected_not_exists or CFG.rewrite_all_screenshots or rewrite_screenshot:\n            actual_screenshot.save(abs_path, save_all=True)\n    \n        screen_diff.attach_diff_to_allure()\n    \n        if screen_diff.has_diff and not CFG.rewrite_all_screenshots:\n>           raise AssertionError(f\"{component_name} screenshot mismatch\")\nE           AssertionError: Category filter screenshot mismatch\n\nsrc/util/screenshot/screenshot_util.py:67: AssertionError","steps":[{"name":"Open [Main Page]: /","time":{"start":1771975638834,"stop":1771975639105,"duration":271},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Expand [Category filter] group: Men","time":{"start":1771975639105,"stop":1771975643713,"duration":4608},"status":"passed","steps":[{"name":"Expand Category filter group Men","time":{"start":1771975639308,"stop":1771975639394,"duration":86},"status":"passed","steps":[{"name":"Click on [Category filter group Men expander] button","time":{"start":1771975639308,"stop":1771975639394,"duration":86},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"stepsCount":1,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"stepsCount":2,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Expand [Category filter] group: Kids","time":{"start":1771975643713,"stop":1771975648232,"duration":4519},"status":"passed","steps":[{"name":"Expand Category filter group Kids","time":{"start":1771975643911,"stop":1771975644076,"duration":165},"status":"passed","steps":[{"name":"Click on [Category filter group Kids expander] button","time":{"start":1771975643913,"stop":1771975644076,"duration":163},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"stepsCount":1,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"stepsCount":2,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Check [Category filter] has expected screenshot: files/screenshot/component/filter/category/expanded_kids.png","time":{"start":1771975648233,"stop":1771975649003,"duration":770},"status":"failed","statusMessage":"AssertionError: Category filter screenshot mismatch\n","statusTrace":"  File \"/automation-exercise-py/src/util/decorator/step_logger.py\", line 75, in wrapper\n    return func(*args, **kwargs)\n  File \"/automation-exercise-py/src/ui/component/base_component.py\", line 67, in check_component_has_screenshot\n    screenshot_util.compare_and_save_screenshot(\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^\n        actual_screenshot=actual_screenshot,\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n        component_name=self._component_title,\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"/automation-exercise-py/src/util/screenshot/screenshot_util.py\", line 67, in compare_and_save_screenshot\n    raise AssertionError(f\"{component_name} screenshot mismatch\")\n","steps":[],"attachments":[{"uid":"9c117bb86a371982","name":"Screenshot diff","source":"9c117bb86a371982.attach","type":"application/vnd.allure.image.diff","size":16036},{"uid":"694531431e93dfa3","name":"Screenshot diff data table","source":"694531431e93dfa3.txt","type":"text/plain","size":343}],"parameters":[],"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":2,"hasContent":true,"attachmentStep":false},{"name":"Get test video from Selenoid by video id = [test_category_filter_should_have_screenshot_when_expand_collapse_expanded]","time":{"start":1771975649241,"stop":1771975653253,"duration":4012},"status":"passed","steps":[{"name":"Send request [GET]: /video/test_category_filter_should_have_screenshot_when_expand_collapse_expanded.mp4","time":{"start":1771975649241,"stop":1771975649244,"duration":3},"status":"passed","steps":[],"attachments":[{"uid":"c9b1a1132588dafb","name":"Request","source":"c9b1a1132588dafb.txt","type":"text/plain","size":397},{"uid":"13bbfd315f414067","name":"Response","source":"13bbfd315f414067.txt","type":"text/plain","size":288}],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":2,"hasContent":true,"attachmentStep":false},{"name":"Send request [GET]: /video/test_category_filter_should_have_screenshot_when_expand_collapse_expanded.mp4","time":{"start":1771975653245,"stop":1771975653253,"duration":8},"status":"passed","steps":[],"attachments":[{"uid":"6cdc3953a821dee0","name":"Request","source":"6cdc3953a821dee0.txt","type":"text/plain","size":397},{"uid":"eb78d0e67369f7f3","name":"Response","source":"eb78d0e67369f7f3.txt","type":"text/plain","size":315}],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":2,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"stepsCount":2,"shouldDisplayMessage":false,"attachmentsCount":4,"hasContent":true,"attachmentStep":false}],"attachments":[{"uid":"7749886be5aeca7a","name":"Screenshot","source":"7749886be5aeca7a.png","type":"image/png","size":340152},{"uid":"1c44f7a68dfc10b1","name":"Page Source","source":"1c44f7a68dfc10b1.html","type":"text/html","size":52716},{"uid":"62f89b274df827e9","name":"Test video","source":"62f89b274df827e9.mp4","type":"video/mp4","size":357290},{"uid":"b7d549dd833e0a63","name":"log","source":"b7d549dd833e0a63.txt","type":"text/plain","size":532},{"uid":"f2e37311123233e7","name":"stderr","source":"f2e37311123233e7.txt","type":"text/plain","size":2532}],"parameters":[],"stepsCount":11,"shouldDisplayMessage":true,"attachmentsCount":11,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"_xunit_setup_method_fixture_TestCategoryFilter::0","time":{"start":1771975653254,"stop":1771975653254,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Each UI test fixture::0","time":{"start":1771975653255,"stop":1771975653255,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"Each test fixtures::0","time":{"start":1771975653256,"stop":1771975653257,"duration":1},"status":"passed","steps":[{"name":"Remove current test users from backend","time":{"start":1771975653256,"stop":1771975653257,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"stepsCount":1,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"All test fixtures::0","time":{"start":1771975720153,"stop":1771975720153,"duration":0},"status":"passed","steps":[{"name":"Remove users from backend after all tests","time":{"start":1771975720153,"stop":1771975720153,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"stepsCount":1,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"labels":[{"name":"story","value":"[Web] Component - Category Filter"},{"name":"feature","value":"Category Filter"},{"name":"owner","value":"arrnel"},{"name":"epic","value":"WEB Component"},{"name":"tag","value":"screenshot_test"},{"name":"tag","value":"web_test"},{"name":"tag","value":"component_test"},{"name":"tag","value":"products_page_test"},{"name":"tag","value":"main_page_test"},{"name":"tag","value":"category_filter_test"},{"name":"tag","value":"filter_test"},{"name":"parentSuite","value":"tests.web.component.filter"},{"name":"suite","value":"test_category_filter"},{"name":"subSuite","value":"TestCategoryFilter"},{"name":"host","value":"2f59bb55debe"},{"name":"thread","value":"12-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.web.component.filter.test_category_filter"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","owner":"arrnel","retries":[],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":2,"broken":0,"skipped":0,"passed":3,"unknown":0,"total":5},"items":[{"uid":"aae2876e33a059bd","reportUrl":"https://arrnel.github.io/automation-exercise-py/nightly/5/#testresult/aae2876e33a059bd","status":"passed","time":{"start":1771964065922,"stop":1771964076231,"duration":10309}},{"uid":"2701298812cc893","reportUrl":"https://arrnel.github.io/automation-exercise-py/nightly/5/#testresult/2701298812cc893","status":"passed","time":{"start":1771962218745,"stop":1771962228611,"duration":9866}},{"uid":"98e5129dcf357d9f","reportUrl":"https://arrnel.github.io/automation-exercise-py/nightly/4/#testresult/98e5129dcf357d9f","status":"failed","statusDetails":"AssertionError: Category filter screenshot mismatch","time":{"start":1771954569163,"stop":1771954578517,"duration":9354}},{"uid":"db4f82294e560dd1","reportUrl":"https://arrnel.github.io/automation-exercise-py/nightly/2/#testresult/db4f82294e560dd1","status":"passed","time":{"start":1771718215335,"stop":1771718224707,"duration":9372}}]},"tags":["web_test","category_filter_test","screenshot_test","products_page_test","component_test","main_page_test","filter_test"]},"source":"4fd950b4898bc726.json","parameterValues":[]}